<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>File Upload Demo</title>
    </head>

    <body>

        <input id="upload-input" type="file">
        <button id="upload-button" onclick="uploadButtonClicked()">Upload</button>

        <script src="https://cdn.jsdelivr.net/npm/appwrite@6.0.1"></script>

<script>

var appwrite = new Appwrite();

async function logIn(email, password) {
    let response = await appwrite.account.createSession(email, password);
}

async function checkIfLoggedIn() {
    try {
        let response = await appwrite.account.get();
        return true;
    } catch (e) {
        return false;
    }
}

async function init() {
    appwrite
        .setEndpoint("https://appwrite.software-engineering.education/v1")
        .setProject("6206644928ab8835c77f"); // crity

    // File upload always fails without a session.
    let alreadyLoggedIn = await checkIfLoggedIn();
    if (!alreadyLoggedIn) {
        await logIn("max.mustermann@example.com", "strenggeheim");
    }
}

async function uploadButtonClicked() {
    try {
        let response = await appwrite.storage.createFile(
            "unique()", 
            document.getElementById("upload-input").files[0], 
            ["role:all"], 
            ["role:all"]
        );
        console.log(response);
    } catch (e) {
        console.error(e);
    }
}

init();

</script>
    </body>
</html>